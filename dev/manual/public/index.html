<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Public Functions · NNMM.jl</title><meta name="title" content="Public Functions · NNMM.jl"/><meta property="og:title" content="Public Functions · NNMM.jl"/><meta property="twitter:title" content="Public Functions · NNMM.jl"/><meta name="description" content="Documentation for NNMM.jl."/><meta property="og:description" content="Documentation for NNMM.jl."/><meta property="twitter:description" content="Documentation for NNMM.jl."/><meta property="og:url" content="https://reworkhow.github.io/NNMM.jl/stable/manual/public/"/><meta property="twitter:url" content="https://reworkhow.github.io/NNMM.jl/stable/manual/public/"/><link rel="canonical" href="https://reworkhow.github.io/NNMM.jl/stable/manual/public/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="NNMM.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">NNMM.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Mixed Effects Neural Networks (NNMM)</span><ul><li><a class="tocitem" href="../../nnmm/Part1_introduction/">Part 1. Introduction</a></li><li><a class="tocitem" href="../../nnmm/Part2_NNMM/">Part 2. NNMM</a></li><li><a class="tocitem" href="../../nnmm/Part3_NNMMwithIntermediateOmics/">Part 3. NNMM with intermediate omics</a></li><li><a class="tocitem" href="../../nnmm/Part4_PartialConnectedNeuralNetwork/">Part 4. Partial connected neural network</a></li><li><a class="tocitem" href="../../nnmm/Part5_UserDefinedNonlinearFunction/">Part 5. User-defined nonlinear function</a></li><li><a class="tocitem" href="../../nnmm/Part6_TraditionalGenomicPrediction/">Part 6. Traditional genomic prediction</a></li></ul></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../getstarted/">Get Started</a></li><li><a class="tocitem" href="../tutorial/">Tutorial</a></li><li class="is-active"><a class="tocitem" href>Public Functions</a><ul class="internal"><li><a class="tocitem" href="#Index"><span>Index</span></a></li><li><a class="tocitem" href="#Core-Types"><span>Core Types</span></a></li><li><a class="tocitem" href="#Main-Functions"><span>Main Functions</span></a></li><li><a class="tocitem" href="#Data-Reading-Functions"><span>Data Reading Functions</span></a></li><li><a class="tocitem" href="#Post-Analysis"><span>Post-Analysis</span></a></li><li><a class="tocitem" href="#Built-in-Datasets"><span>Built-in Datasets</span></a></li><li><a class="tocitem" href="#Pedigree-Functions"><span>Pedigree Functions</span></a></li></ul></li></ul></li><li><a class="tocitem" href="../../citing/citing/">Citing</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Manual</a></li><li class="is-active"><a href>Public Functions</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Public Functions</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/reworkhow/NNMM.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/reworkhow/NNMM.jl/blob/master/docs/src/manual/public.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Public-Functions"><a class="docs-heading-anchor" href="#Public-Functions">Public Functions</a><a id="Public-Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Public-Functions" title="Permalink"></a></h1><p>Documentation for NNMM.jl&#39;s public interface. Below are functions available to general users.</p><h2 id="Index"><a class="docs-heading-anchor" href="#Index">Index</a><a id="Index-1"></a><a class="docs-heading-anchor-permalink" href="#Index" title="Permalink"></a></h2><ul><li><a href="#NNMM.Equation"><code>NNMM.Equation</code></a></li><li><a href="#NNMM.Layer"><code>NNMM.Layer</code></a></li><li><a href="#NNMM.Omics"><code>NNMM.Omics</code></a></li><li><a href="#NNMM.Phenotypes"><code>NNMM.Phenotypes</code></a></li><li><a href="#NNMM.GWAS"><code>NNMM.GWAS</code></a></li><li><a href="#NNMM.getEBV"><code>NNMM.getEBV</code></a></li><li><a href="#NNMM.get_genotypes"><code>NNMM.get_genotypes</code></a></li><li><a href="#NNMM.nnmm_get_genotypes"><code>NNMM.nnmm_get_genotypes</code></a></li><li><a href="#NNMM.nnmm_get_omics"><code>NNMM.nnmm_get_omics</code></a></li><li><a href="#NNMM.read_phenotypes"><code>NNMM.read_phenotypes</code></a></li><li><a href="#NNMM.runNNMM"><code>NNMM.runNNMM</code></a></li></ul><h2 id="Core-Types"><a class="docs-heading-anchor" href="#Core-Types">Core Types</a><a id="Core-Types-1"></a><a class="docs-heading-anchor-permalink" href="#Core-Types" title="Permalink"></a></h2><p>Types for defining the NNMM network architecture.</p><article><details class="docstring" open="true"><summary id="NNMM.Layer"><a class="docstring-binding" href="#NNMM.Layer"><code>NNMM.Layer</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">Layer</code></pre><p>A struct representing a layer in the Neural Network Mixed Model (NNMM).</p><p><strong>Fields</strong></p><ul><li><code>layer_name::String</code>: Name identifier for the layer</li><li><code>data_path</code>: Path to the data file(s) - String for single file, Vector{String} for partial connection</li><li><code>separator</code>: Column separator in the data file (default: &#39;,&#39;)</li><li><code>header</code>: Whether the data file has a header row (default: true)</li><li><code>data</code>: Loaded data (initialized as empty)</li><li><code>quality_control</code>: Whether to perform quality control on genotypes (default: true)</li><li><code>MAF</code>: Minor Allele Frequency threshold for QC (default: 0.01)</li><li><code>missing_value</code>: Value representing missing data (default: 9.0)</li><li><code>center</code>: Whether to center the data (default: true)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/reworkhow/NNMM.jl/blob/c2b4d126d93cc3f513ce8cee72ba32c5d15d9ba6/src/nnmm/types.jl#L17-L32">source</a></section></details></article><article><details class="docstring" open="true"><summary id="NNMM.Equation"><a class="docstring-binding" href="#NNMM.Equation"><code>NNMM.Equation</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">Equation</code></pre><p>A struct representing an equation connecting layers in NNMM.</p><p><strong>Fields</strong></p><ul><li><code>from_layer_name</code>: Source layer name</li><li><code>to_layer_name</code>: Target layer name</li><li><code>equation</code>: Model equation string</li><li><code>omics_name</code>: Names of omics variables (or false if not applicable)</li><li><code>phenotype_name</code>: Names of phenotype variables (or false if not applicable)</li><li><code>covariate</code>: Covariate variable names</li><li><code>random</code>: Random effect specifications</li><li><code>activation_function</code>: Activation function (&quot;linear&quot;, &quot;sigmoid&quot;, &quot;tanh&quot;, etc.)</li><li><code>partial_connect_structure</code>: Structure for partial connectivity</li><li><code>starting_value</code>: Starting values for MCMC</li><li><code>method</code>: Bayesian method (&quot;BayesC&quot;, &quot;BayesA&quot;, &quot;BayesB&quot;, etc.)</li><li><code>Pi</code>: Prior probability of zero effect</li><li><code>estimatePi</code>: Whether to estimate Pi</li><li>Variance parameters for G (genetic) and R (residual)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/reworkhow/NNMM.jl/blob/c2b4d126d93cc3f513ce8cee72ba32c5d15d9ba6/src/nnmm/types.jl#L169-L189">source</a></section></details></article><article><details class="docstring" open="true"><summary id="NNMM.Omics"><a class="docstring-binding" href="#NNMM.Omics"><code>NNMM.Omics</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">Omics</code></pre><p>A struct representing omics data (e.g., transcriptomics, metabolomics) in NNMM.</p><p><strong>Fields</strong></p><ul><li><code>name</code>: Name identifier for this omics category</li><li><code>trait_names</code>: Names for corresponding traits</li><li><code>obsID</code>: Row IDs for individuals</li><li><code>featureID</code>: Feature/omics variable IDs</li><li><code>nObs</code>: Number of observations</li><li><code>nFeatures</code>: Number of omics features</li><li><code>nMarkers</code>: Alias for nFeatures (compatibility)</li><li><code>centered</code>: Whether data is centered</li><li><code>data</code>: The omics data matrix</li><li><code>ntraits</code>: Number of traits in the model</li><li>Additional fields for Bayesian MCMC computations</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/reworkhow/NNMM.jl/blob/c2b4d126d93cc3f513ce8cee72ba32c5d15d9ba6/src/nnmm/types.jl#L58-L75">source</a></section></details></article><article><details class="docstring" open="true"><summary id="NNMM.Phenotypes"><a class="docstring-binding" href="#NNMM.Phenotypes"><code>NNMM.Phenotypes</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">Phenotypes</code></pre><p>A struct representing phenotype data in NNMM.</p><p><strong>Fields</strong></p><ul><li><code>obsID</code>: Individual IDs</li><li><code>featureID</code>: Phenotype/trait names</li><li><code>nObs</code>: Number of observations</li><li><code>nPheno</code>: Number of phenotypes</li><li><code>data</code>: Phenotype data matrix</li><li><code>nFeatures</code>: Alias for nPheno</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/reworkhow/NNMM.jl/blob/c2b4d126d93cc3f513ce8cee72ba32c5d15d9ba6/src/nnmm/types.jl#L142-L154">source</a></section></details></article><h2 id="Main-Functions"><a class="docs-heading-anchor" href="#Main-Functions">Main Functions</a><a id="Main-Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Main-Functions" title="Permalink"></a></h2><p>Primary functions for running NNMM analysis.</p><article><details class="docstring" open="true"><summary id="NNMM.runNNMM"><a class="docstring-binding" href="#NNMM.runNNMM"><code>NNMM.runNNMM</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">runNNMM(layers, equations; kwargs...)</code></pre><p>Run Neural Network Mixed Model (NNMM) analysis.</p><p><strong>Arguments</strong></p><ul><li><code>layers</code>: Vector of 3 <code>Layer</code> objects defining the network architecture<ul><li>Layer 1: Genotypes (SNPs)</li><li>Layer 2: Omics/Latent traits</li><li>Layer 3: Phenotypes</li></ul></li><li><code>equations</code>: Vector of 2 <code>Equation</code> objects defining relationships<ul><li>Equation 1: Genotypes → Omics (1→2)</li><li>Equation 2: Omics → Phenotypes (2→3)</li></ul></li></ul><p><strong>Keyword Arguments</strong></p><p><strong>MCMC Settings</strong></p><ul><li><code>chain_length::Integer=100</code>: Total MCMC iterations</li><li><code>burnin::Integer=0</code>: Number of burn-in iterations to discard</li><li><code>output_samples_frequency::Integer</code>: Save every nth sample (default: auto)</li><li><code>update_priors_frequency::Integer=0</code>: Update prior parameters every n iterations</li></ul><p><strong>Output Settings</strong></p><ul><li><code>outputEBV=true</code>: Output estimated breeding values</li><li><code>output_heritability=true</code>: Calculate heritability estimates</li><li><code>output_folder=&quot;nnmm_results&quot;</code>: Directory for output files</li></ul><p><strong>Computational Settings</strong></p><ul><li><code>seed=false</code>: Random seed for reproducibility</li><li><code>double_precision=false</code>: Use Float64 instead of Float32</li><li><code>big_memory=false</code>: Enable memory-intensive optimizations</li></ul><p><strong>Returns</strong></p><p>A dictionary containing:</p><ul><li>Posterior means for all parameters</li><li>MCMC samples (saved to files)</li><li>EBV estimates</li></ul><p><strong>Example</strong></p><pre><code class="language-julia hljs"># Define layers
layer1 = Layer(name=&quot;geno&quot;, file=&quot;genotypes.csv&quot;)
layer2 = Layer(name=&quot;omics&quot;, file=&quot;omics.csv&quot;)
layer3 = Layer(name=&quot;pheno&quot;, file=&quot;phenotypes.csv&quot;)

# Define equations
eq1 = Equation(&quot;omics = intercept + geno&quot;, 
               method=&quot;BayesC&quot;, omics_name=[&quot;o1&quot;,&quot;o2&quot;])
eq2 = Equation(&quot;pheno = intercept + omics&quot;, 
               activation_function=tanh, phenotype_name=[&quot;y&quot;])

# Run analysis
results = runNNMM([layer1, layer2, layer3], [eq1, eq2],
                  chain_length=5000, burnin=1000)</code></pre><p>See also: <a href="#NNMM.Layer"><code>Layer</code></a>, <a href="#NNMM.Equation"><code>Equation</code></a>, <a href="#DataAPI.describe"><code>describe</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/reworkhow/NNMM.jl/blob/c2b4d126d93cc3f513ce8cee72ba32c5d15d9ba6/src/nnmm/run_mcmc.jl#L19-L75">source</a></section></details></article><article><details class="docstring" open="true"><summary id="DataAPI.describe"><a class="docstring-binding" href="#DataAPI.describe"><code>DataAPI.describe</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">describe(model::MME)</code></pre><p>Print a summary of the mixed model equations (MME) structure.</p><p>Displays:</p><ul><li>Model equations (truncated if &gt;5)</li><li>Term information (classification, fixed/random, number of levels)</li><li>Prior distributions and hyperparameters</li><li>Variance component settings</li><li>Marker effect settings (if genomic data included)</li></ul><p><strong>Arguments</strong></p><ul><li><code>model::MME</code>: The mixed model equations object (created internally by runNNMM)</li></ul><p><strong>Output</strong></p><p>Prints formatted model summary to stdout including:</p><ul><li>Model equations</li><li>Term classification (covariate/factor, fixed/random)</li><li>Prior settings for variance components</li><li>MCMC configuration</li></ul><p><strong>Example</strong></p><pre><code class="language-julia hljs"># After running runNNMM, the describe function is called automatically.
# For manual inspection:
describe(results[&quot;mme&quot;])</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/reworkhow/NNMM.jl/blob/c2b4d126d93cc3f513ce8cee72ba32c5d15d9ba6/src/NNMM.jl#L156-L184">source</a></section></details></article><h2 id="Data-Reading-Functions"><a class="docs-heading-anchor" href="#Data-Reading-Functions">Data Reading Functions</a><a id="Data-Reading-Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Data-Reading-Functions" title="Permalink"></a></h2><p>Functions for reading input data files.</p><article><details class="docstring" open="true"><summary id="NNMM.nnmm_get_genotypes"><a class="docstring-binding" href="#NNMM.nnmm_get_genotypes"><code>NNMM.nnmm_get_genotypes</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">nnmm_get_genotypes(file, G=false; kwargs...)</code></pre><p>Read genotype data for the NNMM model (layer 1).</p><p><strong>Arguments</strong></p><ul><li><code>file</code>: Genotype data source - can be:<ul><li><code>String</code>: Path to CSV file</li><li><code>DataFrame</code>: DataFrame with ID column + marker columns</li><li><code>Matrix</code>: Numeric matrix of genotypes</li></ul></li><li><code>G</code>: Prior genetic variance (default: estimated from data)</li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>method</code>: Bayesian method (&quot;BayesA&quot;, &quot;BayesB&quot;, &quot;BayesC&quot;, &quot;RR-BLUP&quot;, &quot;GBLUP&quot;, &quot;BayesL&quot;)</li><li><code>Pi</code>: Prior inclusion probability (default: 0.0)</li><li><code>estimatePi</code>: Whether to estimate Pi (default: true)</li><li><code>G_is_marker_variance</code>: If true, G is marker variance; if false, G is genetic variance</li><li><code>df</code>: Degrees of freedom for prior (default: 4.0)</li><li><code>quality_control</code>: Perform QC filtering (default: true)</li><li><code>MAF</code>: Minor allele frequency threshold (default: 0.01)</li><li><code>center</code>: Center genotypes (default: true)</li><li><code>separator</code>: File delimiter (default: &#39;,&#39;)</li><li><code>header</code>: File has header row (default: true)</li></ul><p><strong>Returns</strong></p><p><code>Genotypes</code> struct containing processed genotype data and method parameters.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/reworkhow/NNMM.jl/blob/c2b4d126d93cc3f513ce8cee72ba32c5d15d9ba6/src/nnmm/read_files.jl#L21-L47">source</a></section></details></article><article><details class="docstring" open="true"><summary id="NNMM.get_genotypes"><a class="docstring-binding" href="#NNMM.get_genotypes"><code>NNMM.get_genotypes</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">get_genotypes(args...; kwargs...)</code></pre><p>Alias for <a href="#NNMM.nnmm_get_genotypes"><code>nnmm_get_genotypes</code></a>. See that function for full documentation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/reworkhow/NNMM.jl/blob/c2b4d126d93cc3f513ce8cee72ba32c5d15d9ba6/src/nnmm/read_files.jl#L209-L213">source</a></section></details></article><article><details class="docstring" open="true"><summary id="NNMM.nnmm_get_omics"><a class="docstring-binding" href="#NNMM.nnmm_get_omics"><code>NNMM.nnmm_get_omics</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">nnmm_get_omics(file, G=false; kwargs...)</code></pre><p>Read omics data for the NNMM model (layer 2 / middle layer).</p><p><strong>Arguments</strong></p><ul><li><code>file</code>: Path to CSV file containing omics data</li><li><code>G</code>: Prior genetic variance (default: estimated from data)</li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>omics_name</code>: Vector of column names to use as omics features (required)</li><li><code>method</code>: Bayesian method (&quot;BayesA&quot;, &quot;BayesB&quot;, &quot;BayesC&quot;, &quot;RR-BLUP&quot;, &quot;BayesL&quot;)</li><li><code>Pi</code>: Prior inclusion probability (default: 0.0)</li><li><code>estimatePi</code>: Whether to estimate Pi (default: true)</li><li><code>G_is_marker_variance</code>: If true, G is marker variance; if false, G is genetic variance</li><li><code>df</code>: Degrees of freedom for prior (default: 4.0)</li><li><code>constraint</code>: Use independent variances for multi-trait (default: true)</li><li><code>separator</code>: File delimiter (default: &#39;,&#39;)</li><li><code>header</code>: File has header row (default: true)</li><li><code>missing_value</code>: String/value representing missing data (default: false)</li></ul><p><strong>Returns</strong></p><p><code>Omics</code> struct containing the omics data and method parameters.</p><p><strong>Example</strong></p><pre><code class="language-julia hljs">omics = nnmm_get_omics(&quot;omics_data.csv&quot;, 
                       omics_name=[&quot;gene1&quot;, &quot;gene2&quot;, &quot;gene3&quot;],
                       missing_value=&quot;NA&quot;)</code></pre><p><strong>Notes</strong></p><ul><li>First column must be individual IDs</li><li>Missing values will be sampled during MCMC (HMC for latent traits)</li><li>Unlike genotypes, no quality control (MAF filtering) is applied</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/reworkhow/NNMM.jl/blob/c2b4d126d93cc3f513ce8cee72ba32c5d15d9ba6/src/nnmm/read_files.jl#L217-L252">source</a></section></details></article><article><details class="docstring" open="true"><summary id="NNMM.read_phenotypes"><a class="docstring-binding" href="#NNMM.read_phenotypes"><code>NNMM.read_phenotypes</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">read_phenotypes(file; separator=&#39;,&#39;, header=true, missing_value=&quot;NA&quot;, output_folder=&quot;.&quot;)</code></pre><p>Read phenotype data from a CSV file.</p><p><strong>Arguments</strong></p><ul><li><code>file</code>: Path to CSV file containing phenotype data</li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>separator</code>: Column delimiter (default: &#39;,&#39;)</li><li><code>header</code>: Whether file has header row (default: true)</li><li><code>missing_value</code>: String representing missing values (default: &quot;NA&quot;)</li><li><code>output_folder</code>: Directory for output files (default: current directory)</li></ul><p><strong>Returns</strong></p><p><code>DataFrame</code> with phenotype data. First column is individual IDs.</p><p><strong>Example</strong></p><pre><code class="language-julia hljs">pheno_df = read_phenotypes(&quot;phenotypes.csv&quot;, missing_value=&quot;NA&quot;)</code></pre><p><strong>Notes</strong></p><ul><li>First column must contain individual IDs</li><li>Missing values are converted to Julia&#39;s <code>missing</code> type</li><li>A file <code>IDs_for_individuals_with_phenotypes.txt</code> is written to output_folder</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/reworkhow/NNMM.jl/blob/c2b4d126d93cc3f513ce8cee72ba32c5d15d9ba6/src/nnmm/read_files.jl#L331-L357">source</a></section></details></article><h2 id="Post-Analysis"><a class="docs-heading-anchor" href="#Post-Analysis">Post-Analysis</a><a id="Post-Analysis-1"></a><a class="docs-heading-anchor-permalink" href="#Post-Analysis" title="Permalink"></a></h2><p>Functions for analyzing MCMC results.</p><article><details class="docstring" open="true"><summary id="NNMM.GWAS"><a class="docstring-binding" href="#NNMM.GWAS"><code>NNMM.GWAS</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">GWAS(marker_effects_file; header=true)</code></pre><p>Compute the model frequency for each marker.</p><p>Model frequency is the probability that a marker is included in the model (i.e., has non-zero effect) across MCMC samples.</p><p><strong>Arguments</strong></p><ul><li><code>marker_effects_file</code>: Path to CSV file with MCMC samples of marker effects</li><li><code>header</code>: Whether file has header row (default: true)</li></ul><p><strong>Returns</strong></p><p>DataFrame with columns:</p><ul><li><code>marker_ID</code>: Marker identifier</li><li><code>modelfrequency</code>: Proportion of samples where effect ≠ 0</li></ul><p><strong>Example</strong></p><pre><code class="language-julia hljs"># After running NNMM with BayesB or BayesC
freq = GWAS(&quot;nnmm_results/MCMC_samples_marker_effects_genotypes.txt&quot;)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/reworkhow/NNMM.jl/blob/c2b4d126d93cc3f513ce8cee72ba32c5d15d9ba6/src/gwas/GWAS.jl#L27-L49">source</a></section><section><div><pre><code class="language-julia hljs">GWAS(model,map_file,marker_effects_file...;
     window_size = &quot;1 Mb&quot;,sliding_window = false,
     GWAS = true, threshold = 0.001,
     genetic_correlation = false,
     header = true)</code></pre><p>run genomic window-based GWAS</p><ul><li>MCMC samples of marker effects are stored in <strong>marker<em>effects</em>file</strong> with delimiter &#39;,&#39;.</li><li><strong>model</strong> is either the model::MME used in analysis or the genotype cavariate matrix M::Array</li><li><strong>map_file</strong> has the (sorted) marker position information with delimiter &#39;,&#39;. If the map file is not provided, i.e., <strong>map_file</strong>=<code>false</code>, a fake map file will be generated with <strong>window_size</strong> markers in each 1 Mb window, and each 1 Mb window will be tested.</li><li>If two <strong>marker<em>effects</em>file</strong> are provided, and <strong>genetic_correlation</strong> = true, genomic correlation for each window is calculated.</li><li>Statistics are computed for nonoverlapping windows of size <em>window_size</em> by default. If <strong>sliding_window</strong> = true, those for overlapping sliding windows are calculated.</li><li>map file format:</li></ul><pre><code class="nohighlight hljs">markerID,chromosome,position
m1,1,16977
m2,1,434311
m3,1,1025513
m4,2,70350
m5,2,101135</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/reworkhow/NNMM.jl/blob/c2b4d126d93cc3f513ce8cee72ba32c5d15d9ba6/src/gwas/GWAS.jl#L64-L92">source</a></section></details></article><article><details class="docstring" open="true"><summary id="NNMM.getEBV"><a class="docstring-binding" href="#NNMM.getEBV"><code>NNMM.getEBV</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">getEBV(model::MME,traiti)</code></pre><p>(internal function) Get breeding values for individuals defined by outputEBV(), defaulting to all genotyped individuals. This function is used inside MCMC functions for one MCMC samples from posterior distributions. e.g., non-NNBayes<em>partial (multi-classs Bayes) : y1=M1<em>α1[1]+M2</em>α2[1]+M3<em>α3[1]                                            y2=M1</em>α1[2]+M2<em>α2[2]+M3</em>α3[2]; NNBayes</em>partial:     y1=M1<em>α1[1]                      y2=M2</em>α2[1]                      y3=M3*α3[1];</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/reworkhow/NNMM.jl/blob/c2b4d126d93cc3f513ce8cee72ba32c5d15d9ba6/src/io/output.jl#L252-L264">source</a></section></details></article><h2 id="Built-in-Datasets"><a class="docs-heading-anchor" href="#Built-in-Datasets">Built-in Datasets</a><a id="Built-in-Datasets-1"></a><a class="docs-heading-anchor-permalink" href="#Built-in-Datasets" title="Permalink"></a></h2><article><details class="docstring" open="true"><summary id="NNMM.Datasets.dataset"><a class="docstring-binding" href="#NNMM.Datasets.dataset"><code>NNMM.Datasets.dataset</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">dataset(file_name::AbstractString; dataset_name::AbstractString=&quot;&quot;)</code></pre><p>Get the path to a built-in dataset file.</p><p><strong>Arguments</strong></p><ul><li><code>file_name::AbstractString</code>: The name of the file to retrieve</li><li><code>dataset_name::AbstractString=&quot;&quot;</code>: Optional subdirectory name within the data folder</li></ul><p><strong>Returns</strong></p><ul><li><code>String</code>: Full path to the requested data file</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs">phenofile = dataset(&quot;phenotypes.csv&quot;)
genofile = dataset(&quot;genotypes.txt&quot;, dataset_name=&quot;example&quot;)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/reworkhow/NNMM.jl/blob/c2b4d126d93cc3f513ce8cee72ba32c5d15d9ba6/src/datasets/Datasets.jl#L5-L22">source</a></section></details></article><h2 id="Pedigree-Functions"><a class="docs-heading-anchor" href="#Pedigree-Functions">Pedigree Functions</a><a id="Pedigree-Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Pedigree-Functions" title="Permalink"></a></h2><article><details class="docstring" open="true"><summary id="NNMM.PedModule.get_pedigree"><a class="docstring-binding" href="#NNMM.PedModule.get_pedigree"><code>NNMM.PedModule.get_pedigree</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">get_pedigree(pedfile::AbstractString;header=false,separator=&#39;,&#39;,missingstrings=[&quot;0&quot;],output_folder=&quot;.&quot;)</code></pre><ul><li>Get pedigree informtion from a pedigree file with <strong>header</strong> (defaulting to <code>false</code>) , <strong>separator</strong> (defaulting to <code>,</code>) and missing values (defaulting to [&quot;0&quot;])</li><li><code>output_folder</code>: Directory to save diagnostic files (defaulting to current directory)</li><li>Pedigree file format:</li></ul><pre><code class="nohighlight hljs">a,0,0
c,a,b
d,a,c</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/reworkhow/NNMM.jl/blob/c2b4d126d93cc3f513ce8cee72ba32c5d15d9ba6/src/pedigree/PedModule.jl#L10-L22">source</a></section></details></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../tutorial/">« Tutorial</a><a class="docs-footer-nextpage" href="../../citing/citing/">Citing »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Sunday 4 January 2026 19:35">Sunday 4 January 2026</span>. Using Julia version 1.11.8.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
