<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Internals · NNMM.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="NNMM.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit">NNMM.jl</span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../theory/theory/">Some Theory</a></li><li><a class="tocitem" href="../../citing/citing/">Citing</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../getstarted/">Get Started</a></li><li><a class="tocitem" href="../workflow/">Workflow</a></li><li><a class="tocitem" href="../public/">Public</a></li><li class="is-active"><a class="tocitem" href>Internals</a><ul class="internal"><li><a class="tocitem" href="#Index"><span>Index</span></a></li><li><a class="tocitem" href="#Internal-interface"><span>Internal interface</span></a></li></ul></li></ul></li><li><span class="tocitem">Mixed Effects Neural Networks (NNMM)</span><ul><li><a class="tocitem" href="../../nnmm/Part1_introduction/">Part 1. Introduction</a></li><li><a class="tocitem" href="../../nnmm/Part2_NNMM/">Part 2. NNMM</a></li><li><a class="tocitem" href="../../nnmm/Part3_NNMMwithIntermediateOmics/">Part 3. NNMM with intermediate omics</a></li><li><a class="tocitem" href="../../nnmm/Part4_PartialConnectedNeuralNetwork/">Part 4. Partial connected neural network</a></li><li><a class="tocitem" href="../../nnmm/Part5_UserDefinedNonlinearFunction/">Part 5. User-defined nonlinear function</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../../examples/examples/">Examples</a></li></ul></li><li><a class="tocitem" href="../../FrequentlyAskedQuestions/FrequentlyAskedQuestions/">Frequently Asked Questions</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Manual</a></li><li class="is-active"><a href>Internals</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Internals</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/reworkhow/NNMM.jl/blob/master/docs/src/manual/internals.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Internal-functions"><a class="docs-heading-anchor" href="#Internal-functions">Internal functions</a><a id="Internal-functions-1"></a><a class="docs-heading-anchor-permalink" href="#Internal-functions" title="Permalink"></a></h1><p>Documentation for NNMM.jl&#39;s internal (private) interface, which are not available to general users. These internal functions are small blocks that public function build on.</p><p>&lt;!–-</p><h2 id="Index"><a class="docs-heading-anchor" href="#Index">Index</a><a id="Index-1"></a><a class="docs-heading-anchor-permalink" href="#Index" title="Permalink"></a></h2><ul><li><a href="#NNMM.Equation"><code>NNMM.Equation</code></a></li><li><a href="#NNMM.Genotypes"><code>NNMM.Genotypes</code></a></li><li><a href="#NNMM.Layer"><code>NNMM.Layer</code></a></li><li><a href="#NNMM.MCMCinfo"><code>NNMM.MCMCinfo</code></a></li><li><a href="#NNMM.MME"><code>NNMM.MME</code></a></li><li><a href="#NNMM.ModelTerm"><code>NNMM.ModelTerm</code></a></li><li><a href="#NNMM.Omics"><code>NNMM.Omics</code></a></li><li><a href="#NNMM.Phenotypes"><code>NNMM.Phenotypes</code></a></li><li><a href="#NNMM.RandomEffect"><code>NNMM.RandomEffect</code></a></li><li><a href="#NNMM.ResVar"><code>NNMM.ResVar</code></a></li><li><a href="#NNMM.Variance"><code>NNMM.Variance</code></a></li><li><a href="#DataAPI.describe-Tuple{NNMM.MME}"><code>DataAPI.describe</code></a></li><li><a href="#NNMM.GWAS-Tuple{Any, Any, Vararg{AbstractString}}"><code>NNMM.GWAS</code></a></li><li><a href="#NNMM.GWAS-Tuple{Any}"><code>NNMM.GWAS</code></a></li><li><a href="#NNMM.GWAS-Tuple{Any, Any}"><code>NNMM.GWAS</code></a></li><li><a href="#NNMM.PedModule.get_info-Tuple{NNMM.PedModule.Pedigree}"><code>NNMM.PedModule.get_info</code></a></li><li><a href="#NNMM.PedModule.get_pedigree-Tuple{Union{AbstractString, DataFrames.DataFrame}}"><code>NNMM.PedModule.get_pedigree</code></a></li><li><a href="#NNMM.build_model"><code>NNMM.build_model</code></a></li><li><a href="#NNMM.center!-Union{Tuple{AbstractMatrix{T}}, Tuple{T}} where T"><code>NNMM.center!</code></a></li><li><a href="#NNMM.getEBV-Tuple{Any, Any}"><code>NNMM.getEBV</code></a></li><li><a href="#NNMM.getMCMCinfo-Tuple{Any}"><code>NNMM.getMCMCinfo</code></a></li><li><a href="#NNMM.getMME-Tuple{NNMM.MME, DataFrames.DataFrame}"><code>NNMM.getMME</code></a></li><li><a href="#NNMM.get_column_ref-Union{Tuple{AbstractMatrix{T}}, Tuple{T}} where T"><code>NNMM.get_column_ref</code></a></li><li><a href="#NNMM.make_incidence_matrices-Tuple{Any, Any, Any}"><code>NNMM.make_incidence_matrices</code></a></li><li><a href="#NNMM.mkDict-Union{Tuple{Vector{T}}, Tuple{T}} where T"><code>NNMM.mkDict</code></a></li><li><a href="#NNMM.mkmat_incidence_factor-Tuple{Vector, Vector}"><code>NNMM.mkmat_incidence_factor</code></a></li><li><a href="#NNMM.outputEBV-Tuple{Any, Any}"><code>NNMM.outputEBV</code></a></li><li><a href="#NNMM.outputMCMCsamples-Tuple{NNMM.MME, Vararg{AbstractString}}"><code>NNMM.outputMCMCsamples</code></a></li><li><a href="#NNMM.output_MCMC_samples"><code>NNMM.output_MCMC_samples</code></a></li><li><a href="#NNMM.output_MCMC_samples_setup"><code>NNMM.output_MCMC_samples_setup</code></a></li><li><a href="#NNMM.output_location_parameters_samples-Tuple{NNMM.MME, Any, Any}"><code>NNMM.output_location_parameters_samples</code></a></li><li><a href="#NNMM.prediction_setup-Tuple{Any}"><code>NNMM.prediction_setup</code></a></li><li><a href="#NNMM.runMCMC-Tuple{NNMM.MME, Any}"><code>NNMM.runMCMC</code></a></li><li><a href="#NNMM.set_covariate-Tuple{NNMM.MME, Vararg{AbstractString}}"><code>NNMM.set_covariate</code></a></li><li><a href="#NNMM.set_random"><code>NNMM.set_random</code></a></li><li><a href="#NNMM.set_random"><code>NNMM.set_random</code></a></li><li><a href="#NNMM.solve-Tuple{NNMM.MME, DataFrames.DataFrame}"><code>NNMM.solve</code></a></li><li><a href="#NNMM.transubstrarr-Tuple{Any}"><code>NNMM.transubstrarr</code></a></li></ul><h2 id="Internal-interface"><a class="docs-heading-anchor" href="#Internal-interface">Internal interface</a><a id="Internal-interface-1"></a><a class="docs-heading-anchor-permalink" href="#Internal-interface" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="DataAPI.describe-Tuple{NNMM.MME}" href="#DataAPI.describe-Tuple{NNMM.MME}"><code>DataAPI.describe</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">describe(model::MME)</code></pre><ul><li>Print out model information.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/reworkhow/NNMM.jl/blob/a3fb92743aed49c2adfc117215a542a79256ea67/src/NNMM.jl#L400-L404">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="NNMM.GWAS-Tuple{Any, Any, Vararg{AbstractString}}" href="#NNMM.GWAS-Tuple{Any, Any, Vararg{AbstractString}}"><code>NNMM.GWAS</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">GWAS(model,map_file,marker_effects_file...;
     window_size = &quot;1 Mb&quot;,sliding_window = false,
     GWAS = true, threshold = 0.001,
     genetic_correlation = false,
     header = true)</code></pre><p>run genomic window-based GWAS</p><ul><li>MCMC samples of marker effects are stored in <strong>marker<em>effects</em>file</strong> with delimiter &#39;,&#39;.</li><li><strong>model</strong> is either the model::MME used in analysis or the genotype cavariate matrix M::Array</li><li><strong>map_file</strong> has the (sorted) marker position information with delimiter &#39;,&#39;. If the map file is not provided, i.e., <strong>map_file</strong>=<code>false</code>, a fake map file will be generated with <strong>window_size</strong> markers in each 1 Mb window, and each 1 Mb window will be tested.</li><li>If two <strong>marker<em>effects</em>file</strong> are provided, and <strong>genetic_correlation</strong> = true, genomic correlation for each window is calculated.</li><li>Statistics are computed for nonoverlapping windows of size <em>window_size</em> by default. If <strong>sliding_window</strong> = true, those for overlapping sliding windows are calculated.</li><li>map file format:</li></ul><pre><code class="language-none">markerID,chromosome,position
m1,1,16977
m2,1,434311
m3,1,1025513
m4,2,70350
m5,2,101135</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/reworkhow/NNMM.jl/blob/a3fb92743aed49c2adfc117215a542a79256ea67/src/gwas/GWAS.jl#L22-L50">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="NNMM.GWAS-Tuple{Any, Any}" href="#NNMM.GWAS-Tuple{Any, Any}"><code>NNMM.GWAS</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">GWAS(marker_effects_file,model;header=true,window_size=100,threshold=0.001)</code></pre><p>run genomic window-based GWAS without a map file</p><ul><li>MCMC samples of marker effects are stored in <strong>marker<em>effects</em>file</strong> with delimiter &#39;,&#39;.</li><li><strong>window_size</strong> is either a constant (identical number of markers in each window) or an array of number of markers in each window</li><li><strong>model</strong> is either the model::MME used in analysis or the genotypic covariate matrix M::Array</li><li>File format:</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/reworkhow/NNMM.jl/blob/a3fb92743aed49c2adfc117215a542a79256ea67/src/gwas/GWAS_deprecated.jl#L1-L11">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="NNMM.GWAS-Tuple{Any}" href="#NNMM.GWAS-Tuple{Any}"><code>NNMM.GWAS</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">GWAS(marker_effects_file;header=true)</code></pre><p>Compute the model frequency for each marker (the probability the marker is included in the model) using samples of marker effects stored in <strong>marker<em>effects</em>file</strong>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/reworkhow/NNMM.jl/blob/a3fb92743aed49c2adfc117215a542a79256ea67/src/gwas/GWAS.jl#L3-L7">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="NNMM.build_model" href="#NNMM.build_model"><code>NNMM.build_model</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">build_model(model_equations::AbstractString,R=false; df::AbstractFloat=4.0, estimate_variance=true)</code></pre><ul><li>Build a model from <strong>model equations</strong> with the residual variance <strong>R</strong>. In Bayesian analysis, <strong>R</strong> is the mean for the prior assigned for the residual variance with degree of freedom <strong>df</strong>, defaulting to 4.0. If <strong>R</strong> is not provided, a value is calculated from responses (phenotypes).</li><li>By default, all variabels in model<em>equations are factors (categorical) and fixed. Set variables to be covariates (continuous) or random using functions `set</em>covariate()<code>or</code>set_random()`.</li><li>The argument <code>estimate_variance</code> indicates whether to estimate the residual variance; <code>estimate_variance=true</code> is the default.</li></ul><pre><code class="language-julia">#single-trait
model_equations = &quot;BW = intercept + age + sex&quot;
R               = 6.72
models          = build_model(model_equations,R);

#multi-trait
model_equations = &quot;BW = intercept + age + sex
                   CW = intercept + litter&quot;;
R               = [6.72   24.84
                   24.84  708.41]
models          = build_model(model_equations,R);</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/reworkhow/NNMM.jl/blob/a3fb92743aed49c2adfc117215a542a79256ea67/src/core/build_MME.jl#L18-L41">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="NNMM.center!-Union{Tuple{AbstractMatrix{T}}, Tuple{T}} where T" href="#NNMM.center!-Union{Tuple{AbstractMatrix{T}}, Tuple{T}} where T"><code>NNMM.center!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">This function centers columns of the input matrix X by subtracting their means along each column. The function operates in-place by modifying the original matrix X.

Input:
- X::AbstractMatrix: a matrix to be centered

Output:
- col_means::Vector: a vector of mean values for each column in the original matrix, computed before centering.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/reworkhow/NNMM.jl/blob/a3fb92743aed49c2adfc117215a542a79256ea67/src/markers/genotype_tools.jl#L12-L20">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="NNMM.getEBV-Tuple{Any, Any}" href="#NNMM.getEBV-Tuple{Any, Any}"><code>NNMM.getEBV</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">getEBV(model::MME,traiti)</code></pre><p>(internal function) Get breeding values for individuals defined by outputEBV(), defaulting to all genotyped individuals. This function is used inside MCMC functions for one MCMC samples from posterior distributions. e.g., non-NNBayes<em>partial (multi-classs Bayes) : y1=M1<em>α1[1]+M2</em>α2[1]+M3<em>α3[1]                                            y2=M1</em>α1[2]+M2<em>α2[2]+M3</em>α3[2]; NNBayes</em>partial:     y1=M1<em>α1[1]                      y2=M2</em>α2[1]                      y3=M3*α3[1];</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/reworkhow/NNMM.jl/blob/a3fb92743aed49c2adfc117215a542a79256ea67/src/io/output.jl#L241-L253">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="NNMM.getMCMCinfo-Tuple{Any}" href="#NNMM.getMCMCinfo-Tuple{Any}"><code>NNMM.getMCMCinfo</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">getMCMCinfo(model::MME)</code></pre><ul><li>(internal function) Print out MCMC information.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/reworkhow/NNMM.jl/blob/a3fb92743aed49c2adfc117215a542a79256ea67/src/NNMM.jl#L456-L460">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="NNMM.getMME-Tuple{NNMM.MME, DataFrames.DataFrame}" href="#NNMM.getMME-Tuple{NNMM.MME, DataFrames.DataFrame}"><code>NNMM.getMME</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Construct mixed model equations with</p><p>incidence matrix: X      ; response        : ySparse; left-hand side  : mmeLhs ; right-hand side : mmeLhs ;</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/reworkhow/NNMM.jl/blob/a3fb92743aed49c2adfc117215a542a79256ea67/src/core/build_MME.jl#L284-L291">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="NNMM.get_column_ref-Union{Tuple{AbstractMatrix{T}}, Tuple{T}} where T" href="#NNMM.get_column_ref-Union{Tuple{AbstractMatrix{T}}, Tuple{T}} where T"><code>NNMM.get_column_ref</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">get_column_ref(X::Vector{T})

To obtain a vector of views (alias/pointer) for each column of the input matrix WITHOUT COPYING the underlying data. 
input:  a matrix X
output: a vector containing views of each column of the input matrix X</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/reworkhow/NNMM.jl/blob/a3fb92743aed49c2adfc117215a542a79256ea67/src/markers/genotype_tools.jl#L1-L7">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="NNMM.make_incidence_matrices-Tuple{Any, Any, Any}" href="#NNMM.make_incidence_matrices-Tuple{Any, Any, Any}"><code>NNMM.make_incidence_matrices</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">make_incidence_matrices(mme,df_whole,train_index)</code></pre><ul><li>(internal function) Make incidence matrices for effects involved in</li></ul><p>calculation of EBV except marker covariates.</p><ul><li>Both incidence matrices for non-missing observations (used in mixed model equations)</li></ul><p>and individuals of interest (output IDs) are obtained.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/reworkhow/NNMM.jl/blob/a3fb92743aed49c2adfc117215a542a79256ea67/src/io/input_validation.jl#L380-L387">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="NNMM.mkDict-Union{Tuple{Vector{T}}, Tuple{T}} where T" href="#NNMM.mkDict-Union{Tuple{Vector{T}}, Tuple{T}} where T"><code>NNMM.mkDict</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">mkDict(a::Vector{T}) where T &lt;: Any

Get column index in the incidence matrix for each level of a factor (categorical variable) 
input:  a=[&quot;a1&quot;,&quot;a4&quot;,&quot;a1&quot;,&quot;a2&quot;] 
output: d=Dict(&quot;a2&quot; =&gt; 3, &quot;a1&quot; =&gt; 1, &quot;a4&quot; =&gt; 2), level_names=[&quot;a1&quot;,&quot;a4&quot;,&quot;a2&quot;]

note: enumerate(level_names) gives a list of tuples (index, element), reverse() to reverse (index,element) to (element,index)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/reworkhow/NNMM.jl/blob/a3fb92743aed49c2adfc117215a542a79256ea67/src/core/build_MME.jl#L1-L9">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="NNMM.mkmat_incidence_factor-Tuple{Vector, Vector}" href="#NNMM.mkmat_incidence_factor-Tuple{Vector, Vector}"><code>NNMM.mkmat_incidence_factor</code></a> — <span class="docstring-category">Method</span></header><section><div><p>mkmat<em>incidence</em>factor(yID::Vector, uID::Vector)     create an incidence matrix Z to reorder uID to yID by yID = Z<em>uID.     input:          - yID: a vector containing the desired order of IDs         - uID: a vector containing the original order of IDs     output:          - Z: a sparse matrix representing the incidence relationship between yID and uID (yID = Z</em>uID)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/reworkhow/NNMM.jl/blob/a3fb92743aed49c2adfc117215a542a79256ea67/src/markers/genotype_tools.jl#L187-L195">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="NNMM.outputEBV-Tuple{Any, Any}" href="#NNMM.outputEBV-Tuple{Any, Any}"><code>NNMM.outputEBV</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">outputEBV(model,IDs::Array)</code></pre><p>Output estimated breeding values and prediction error variances for IDs.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/reworkhow/NNMM.jl/blob/a3fb92743aed49c2adfc117215a542a79256ea67/src/io/output.jl#L61-L65">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="NNMM.outputMCMCsamples-Tuple{NNMM.MME, Vararg{AbstractString}}" href="#NNMM.outputMCMCsamples-Tuple{NNMM.MME, Vararg{AbstractString}}"><code>NNMM.outputMCMCsamples</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">outputMCMCsamples(mme::MME,trmStrs::AbstractString...)</code></pre><p>Get MCMC samples for specific location parameters.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/reworkhow/NNMM.jl/blob/a3fb92743aed49c2adfc117215a542a79256ea67/src/io/output.jl#L71-L75">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="NNMM.output_MCMC_samples" href="#NNMM.output_MCMC_samples"><code>NNMM.output_MCMC_samples</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">output_MCMC_samples(mme,vRes,G0,outfile=false)</code></pre><p>(internal function) Save MCMC samples every output<em>samples</em>frequency iterations to the text file.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/reworkhow/NNMM.jl/blob/a3fb92743aed49c2adfc117215a542a79256ea67/src/io/output.jl#L428-L432">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="NNMM.output_MCMC_samples_setup" href="#NNMM.output_MCMC_samples_setup"><code>NNMM.output_MCMC_samples_setup</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">output_MCMC_samples_setup(mme,nIter,output_samples_frequency,file_name=&quot;MCMC_samples&quot;)</code></pre><p>(internal function) Set up text files to save MCMC samples.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/reworkhow/NNMM.jl/blob/a3fb92743aed49c2adfc117215a542a79256ea67/src/io/output.jl#L296-L300">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="NNMM.output_location_parameters_samples-Tuple{NNMM.MME, Any, Any}" href="#NNMM.output_location_parameters_samples-Tuple{NNMM.MME, Any, Any}"><code>NNMM.output_location_parameters_samples</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">output_location_parameters_samples(mme::MME,sol,outfile)</code></pre><p>(internal function) Save MCMC samples for location parameers</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/reworkhow/NNMM.jl/blob/a3fb92743aed49c2adfc117215a542a79256ea67/src/io/output.jl#L530-L534">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="NNMM.prediction_setup-Tuple{Any}" href="#NNMM.prediction_setup-Tuple{Any}"><code>NNMM.prediction_setup</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">prediction_setup(mme::MME)</code></pre><ul><li>(internal function) Create incidence matrices for individuals of interest based on a usere-defined</li></ul><p>prediction equation, defaulting to genetic values including effects defined with genomic and pedigre information. For now, genomic data is always included.</p><ul><li>J and ϵ are always included in single-step analysis (added in SSBR.jl)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/reworkhow/NNMM.jl/blob/a3fb92743aed49c2adfc117215a542a79256ea67/src/io/output.jl#L21-L28">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="NNMM.runMCMC-Tuple{NNMM.MME, Any}" href="#NNMM.runMCMC-Tuple{NNMM.MME, Any}"><code>NNMM.runMCMC</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">runMCMC(model::MME,df::DataFrame;
        #Data
        heterogeneous_residuals           = false,
        #MCMC
        chain_length::Integer             = 100,
        starting_value                    = false,
        burnin::Integer                   = 0,
        output_samples_frequency::Integer = chain_length&gt;1000 ? div(chain_length,1000) : 1,
        update_priors_frequency::Integer  = 0,
        #Methods
        single_step_analysis            = false, #parameters for single-step analysis
        pedigree                        = false, #parameters for single-step analysis
        fitting_J_vector                = true,  #parameters for single-step analysis
        categorical_trait               = false,
        censored_trait                  = false,
        causal_structure                = false,
        mega_trait                      = false,
        missing_phenotypes              = true,
        constraint                      = false,
        #Genomic Prediction
        outputEBV                       = true,
        output_heritability             = true,
        prediction_equation             = false,
        #MISC
        seed                            = false,
        printout_model_info             = true,
        printout_frequency              = chain_length+1,
        big_memory                      = false,
        double_precision                = false,
        ##MCMC samples (defaut to marker effects and hyperparametes (variance components))
        output_folder                     = &quot;results&quot;,
        output_samples_for_all_parameters = false,
        ##for deprecated NNMM
        methods                         = &quot;conventional (no markers)&quot;,
        Pi                              = 0.0,
        estimatePi                      = false)</code></pre><p><strong>Run MCMC for Bayesian Linear Mixed Models with or without estimation of variance components.</strong></p><ul><li>Markov chain Monte Carlo<ul><li>The first <code>burnin</code> iterations are discarded at the beginning of a MCMC chain of length <code>chain_length</code>.</li><li>Save MCMC samples every <code>output_samples_frequency</code> iterations, defaulting to <code>chain_length/1000</code>, to a folder <code>output_folder</code>, defaulting to <code>results</code>. MCMC samples for hyperparametes (variance componets) and marker effects are saved by default. MCMC samples for location parametes can be saved using function <code>output_MCMC_samples()</code>. Note that saving MCMC samples too frequently slows down the computation.</li><li>The <code>starting_value</code> can be provided as a vector for all location parameteres and marker effects, defaulting to <code>0.0</code>s. The order of starting values for location parameters and marker effects should be the order of location parameters in the Mixed Model Equation for all traits (This can be obtained by getNames(model)) and then markers for all traits (all markers for trait 1 then all markers for trait 2...).</li><li>Miscellaneous Options<ul><li>Priors are updated every <code>update_priors_frequency</code> iterations, defaulting to <code>0</code>.</li></ul></li></ul></li><li>Methods<ul><li>Single step analysis is allowed if <code>single_step_analysis</code> = <code>true</code> and <code>pedigree</code> is provided.</li><li>Miscellaneous Options<ul><li>Missing phenotypes are allowed in multi-trait analysis with <code>missing_phenotypes</code>=true, defaulting to <code>true</code>.</li><li>Catogorical Traits are allowed if <code>categorical_trait</code>=true, defaulting to <code>false</code>. Phenotypes should be coded as 1,2,3...</li><li>Censored traits are allowed if the upper bounds are provided in <code>censored_trait</code> as an array, and lower bounds are provided as phenotypes.</li><li>If <code>constraint</code>=true, defaulting to <code>false</code>, constrain residual covariances between traits to be zeros.</li><li>If <code>causal_structure</code> is provided, e.g., causal_structure = [0.0 0.0 0.0;1.0 0.0 0.0;1.0 0.0 0.0] for trait 1 -&gt; trait 2 and trait 1 -&gt; trait 3 (column index affacts row index, and a lower triangular matrix is required), phenotypic causal networks will be incorporated using structure equation models.</li></ul></li></ul></li><li>Genomic Prediction<ul><li>Predicted values for individuals of interest can be obtained based on a user-defined prediction equation <code>prediction_equation</code>, e.g., &quot;y1:animal + y1:age&quot;.</li></ul>For now, genomic data is always included. Genetic values including effects defined with genotype and pedigree information are returned if <code>prediction_equation</code>= false, defaulting to <code>false</code>.<ul><li>Individual estimted genetic values and prediction error variances (PEVs) are returned if <code>outputEBV</code>=true, defaulting to <code>true</code>. Heritability and genetic</li></ul>variances are returned if <code>output_heritability</code>=<code>true</code>, defaulting to <code>true</code>. Note that estimation of heritability is computaionally intensive.</li><li>Miscellaneous Options<ul><li>Print out the model information in REPL if <code>printout_model_info</code>=true; print out the monte carlo mean in REPL with <code>printout_frequency</code>, defaulting to <code>false</code>.</li><li>If <code>seed</code>, defaulting to <code>false</code>, is provided, a reproducible sequence of numbers will be generated for random number generation.</li><li>If <code>big_memory</code>=true, defaulting to <code>false</code>, a machine with  lots of memory is assumed which may speed up the analysis.</li></ul></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/reworkhow/NNMM.jl/blob/a3fb92743aed49c2adfc117215a542a79256ea67/src/NNMM.jl#L78-L149">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="NNMM.set_covariate-Tuple{NNMM.MME, Vararg{AbstractString}}" href="#NNMM.set_covariate-Tuple{NNMM.MME, Vararg{AbstractString}}"><code>NNMM.set_covariate</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">set_covariate(model::MME,variables::AbstractString...)</code></pre><ul><li>set <strong>variables</strong> as covariates; <strong>model</strong> is the output of function <code>build_model()</code>.</li></ul><pre><code class="language-julia">#After running build_model, variabels age and year can be set to be covariates as
set_covariate(model,&quot;age&quot;,&quot;year&quot;)
#or
set_covariate(model,&quot;age year&quot;)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/reworkhow/NNMM.jl/blob/a3fb92743aed49c2adfc117215a542a79256ea67/src/core/build_MME.jl#L150-L161">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="NNMM.set_random" href="#NNMM.set_random"><code>NNMM.set_random</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">set_random(mme::MME,randomStr::AbstractString,ped::Pedigree, G;df=4)</code></pre><ul><li>set variables as random polygenic effects with pedigree information <strong>ped</strong>. and variances <strong>G</strong>.</li><li><strong>G</strong> is the mean for the prior assigned for the variance with degree of freedom <strong>df</strong>, defaulting to 4.0. If <strong>G</strong> is not provided, a value is calculated from responses (phenotypes).</li></ul><pre><code class="language-julia">#single-trait (example 1)
model_equation  = &quot;y = intercept + age + animal&quot;
model           = build_model(model_equation,R)
ped             = get_pedigree(pedfile)
G               = 1.6
set_random(model,&quot;animal&quot;, ped, G)

#single-trait (example 2)
model_equation  = &quot;y = intercept + age + animal + animal*age&quot;
model           = build_model(model_equation,R)
ped             = get_pedigree(pedfile)
G               = [1.6   0.2
                   0.2  1.0]
set_random(model,&quot;animal animal*age&quot;, ped,G)

#multi-trait
model_equations = &quot;BW = intercept + age + sex + animal
                   CW = intercept + age + sex + animal&quot;
model           = build_model(model_equations,R);
ped             = get_pedigree(pedfile);
G               = [6.72   2.84
                   2.84  8.41]
set_random(model,&quot;animal&quot;,ped,G)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/reworkhow/NNMM.jl/blob/a3fb92743aed49c2adfc117215a542a79256ea67/src/core/random_effects.jl#L5-L39">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="NNMM.set_random" href="#NNMM.set_random"><code>NNMM.set_random</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">set_random(mme::MME,randomStr::AbstractString,G;Vinv=0,names=[],df=4)</code></pre><ul><li>set variables as random effects, defaulting to i.i.d effects, with variances <strong>G</strong>.</li><li><strong>G</strong> is the mean for the prior assigned for the variance with degree of freedom <strong>df</strong>, defaulting to 4.0. If <strong>G</strong> is not provided, a value is calculated from responses (phenotypes).</li><li>the random effects are assumed to be i.i.d by default and it can be defined with any (inverse of) covariance structure <strong>Vinv</strong> with its index (row names) provided by <strong>names</strong>.</li></ul><pre><code class="language-julia">#single-trait (i.i.d randome effects)
model_equation  = &quot;y = intercept + litter + sex&quot;
model           = build_model(model_equation,R)
G               = 0.6
set_random(model,&quot;litter&quot;,G)

#multi-trait (i.i.d randome effects)
model_equations = &quot;BW = intercept + litter + sex
                   CW = intercept + litter + sex&quot;
model           = build_model(model_equations,R);
G               = [3.72  1.84
                   1.84  3.41]
set_random(model,&quot;litter&quot;,G)

#single-trait (randome effects with specific covariance structures)
model_equation  = &quot;y = intercept + litter + sex&quot;
model           = build_model(model_equation,R)
V               = [1.0  0.5 0.25
                   0.5  1.0 0.5
                   0.25 0.5 1.0]
G               = 0.6
set_random(model,&quot;litter&quot;,G,Vinv=inv(V),names=[a1;a2;a3])</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/reworkhow/NNMM.jl/blob/a3fb92743aed49c2adfc117215a542a79256ea67/src/core/random_effects.jl#L59-L92">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="NNMM.solve-Tuple{NNMM.MME, DataFrames.DataFrame}" href="#NNMM.solve-Tuple{NNMM.MME, DataFrames.DataFrame}"><code>NNMM.solve</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">solve(mme::MME,df::DataFrame;solver=&quot;default&quot;,printout_frequency=100,tolerance = 0.000001,maxiter = 5000)</code></pre><ul><li>Solve the mixed model equations (no marker information) without estimating variance components.</li></ul><p>Available solvers include <code>default</code>, <code>Jacobi</code>, <code>Gauss-Seidel</code>, and <code>Gibbs sampler</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/reworkhow/NNMM.jl/blob/a3fb92743aed49c2adfc117215a542a79256ea67/src/solvers/iterative_solver.jl#L1-L6">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="NNMM.transubstrarr-Tuple{Any}" href="#NNMM.transubstrarr-Tuple{Any}"><code>NNMM.transubstrarr</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">transubstrarr(vec)</code></pre><p>(internal function) Transpose a column vector of strings (vec&#39; doesn&#39;t work here)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/reworkhow/NNMM.jl/blob/a3fb92743aed49c2adfc117215a542a79256ea67/src/io/output.jl#L544-L548">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="NNMM.Equation" href="#NNMM.Equation"><code>NNMM.Equation</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">Equation</code></pre><p>A struct representing an equation connecting layers in NNMM.</p><p><strong>Fields</strong></p><ul><li><code>from_layer_name</code>: Source layer name</li><li><code>to_layer_name</code>: Target layer name</li><li><code>equation</code>: Model equation string</li><li><code>omics_name</code>: Names of omics variables (or false if not applicable)</li><li><code>phenotype_name</code>: Names of phenotype variables (or false if not applicable)</li><li><code>covariate</code>: Covariate variable names</li><li><code>random</code>: Random effect specifications</li><li><code>activation_function</code>: Activation function (&quot;linear&quot;, &quot;sigmoid&quot;, &quot;tanh&quot;, etc.)</li><li><code>partial_connect_structure</code>: Structure for partial connectivity</li><li><code>starting_value</code>: Starting values for MCMC</li><li><code>method</code>: Bayesian method (&quot;BayesC&quot;, &quot;BayesA&quot;, &quot;BayesB&quot;, etc.)</li><li><code>Pi</code>: Prior probability of zero effect</li><li><code>estimatePi</code>: Whether to estimate Pi</li><li>Variance parameters for G (genetic) and R (residual)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/reworkhow/NNMM.jl/blob/a3fb92743aed49c2adfc117215a542a79256ea67/src/nnmm/types.jl#L153-L173">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="NNMM.Genotypes" href="#NNMM.Genotypes"><code>NNMM.Genotypes</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">Genotypes</code></pre><p>A struct for storing genotype data and associated parameters for genomic prediction.</p><p><strong>Fields</strong></p><ul><li><code>name</code>: Category name (e.g., &quot;geno1&quot;)</li><li><code>trait_names</code>: Names of corresponding traits (e.g., [&quot;y1&quot;, &quot;y2&quot;])</li><li><code>obsID</code>: Individual IDs for genotyped and phenotyped individuals</li><li><code>markerID</code>: Marker/SNP identifiers</li><li><code>nObs</code>: Number of observations</li><li><code>nMarkers</code>: Number of markers</li><li><code>alleleFreq</code>: Allele frequencies</li><li><code>sum2pq</code>: Sum of 2<em>p</em>q for all markers</li><li><code>centered</code>: Whether genotypes are centered</li><li><code>genotypes</code>: Genotype matrix</li><li><code>genetic_variance</code>: Genetic variance (Variance struct)</li><li><code>G</code>: Marker effect variance (Variance struct)</li><li><code>method</code>: Bayesian method (&quot;BayesA&quot;, &quot;BayesB&quot;, &quot;BayesC&quot;, etc.)</li><li><code>estimatePi</code>: Whether to estimate Pi</li><li>MCMC-related arrays (α, β, δ, π, etc.)</li><li>Result arrays (meanAlpha, meanVara, etc.)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/reworkhow/NNMM.jl/blob/a3fb92743aed49c2adfc117215a542a79256ea67/src/core/types.jl#L152-L174">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="NNMM.Layer" href="#NNMM.Layer"><code>NNMM.Layer</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">Layer</code></pre><p>A struct representing a layer in the Neural Network Mixed Model (NNMM).</p><p><strong>Fields</strong></p><ul><li><code>layer_name::String</code>: Name identifier for the layer</li><li><code>data_path</code>: Path to the data file(s) - String for single file, Vector{String} for partial connection</li><li><code>separator</code>: Column separator in the data file (default: &#39;,&#39;)</li><li><code>header</code>: Whether the data file has a header row (default: true)</li><li><code>data</code>: Loaded data (initialized as empty)</li><li><code>quality_control</code>: Whether to perform quality control on genotypes (default: true)</li><li><code>MAF</code>: Minor Allele Frequency threshold for QC (default: 0.01)</li><li><code>missing_value</code>: Value representing missing data (default: 9.0)</li><li><code>center</code>: Whether to center the data (default: true)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/reworkhow/NNMM.jl/blob/a3fb92743aed49c2adfc117215a542a79256ea67/src/nnmm/types.jl#L1-L16">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="NNMM.MCMCinfo" href="#NNMM.MCMCinfo"><code>NNMM.MCMCinfo</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">MCMCinfo</code></pre><p>A struct for storing MCMC run configuration and parameters.</p><p><strong>Fields</strong></p><ul><li><code>heterogeneous_residuals</code>: Whether to use heterogeneous residual variances</li><li><code>chain_length</code>: Total number of MCMC iterations</li><li><code>burnin</code>: Number of burn-in iterations to discard</li><li><code>output_samples_frequency</code>: How often to save MCMC samples</li><li><code>printout_model_info</code>: Whether to print model information</li><li><code>printout_frequency</code>: How often to print progress</li><li><code>single_step_analysis</code>: Whether using single-step genomic evaluation</li><li><code>fitting_J_vector</code>: Whether to fit J vector in single-step</li><li><code>missing_phenotypes</code>: Whether to handle missing phenotypes</li><li><code>update_priors_frequency</code>: How often to update priors</li><li><code>outputEBV</code>: Whether to output estimated breeding values</li><li><code>output_heritability</code>: Whether to output heritability estimates</li><li><code>prediction_equation</code>: Custom prediction equation</li><li><code>seed</code>: Random seed for reproducibility</li><li><code>double_precision</code>: Whether to use Float64 precision</li><li><code>output_folder</code>: Directory for output files</li><li><code>RRM</code>: Random regression model parameters</li><li><code>fast_blocks</code>: Block size for fast sampling</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/reworkhow/NNMM.jl/blob/a3fb92743aed49c2adfc117215a542a79256ea67/src/core/types.jl#L239-L263">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="NNMM.MME" href="#NNMM.MME"><code>NNMM.MME</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">MME</code></pre><p>Mixed Model Equations - the main struct for Bayesian Linear Mixed Models.</p><p>Supports:</p><ul><li>Single-trait analysis: lambda version of MME</li><li>Multi-trait analysis: formal version of MME</li></ul><p>Scale parameters for variance components are computed when variances are added:</p><ul><li><code>build_model()</code> for residual variance</li><li><code>set_random()</code> for non-marker random effects</li><li><code>set_marker_hyperparameters_variances_and_pi()</code> for marker effect variance</li></ul><p><strong>Key Fields</strong></p><ul><li><code>nModels</code>: Number of model equations (traits)</li><li><code>modelVec</code>: Array of model equation strings</li><li><code>modelTerms</code>: Array of ModelTerm objects</li><li><code>modelTermDict</code>: Dictionary mapping term strings to ModelTerm objects</li><li><code>lhsVec</code>: Phenotype symbols (e.g., [:y1, :y2])</li><li><code>covVec</code>: Covariate symbols</li><li><code>X</code>: Incidence matrix</li><li><code>ySparse</code>: Phenotype vector</li><li><code>obsID</code>: Individual IDs</li><li><code>mmeLhs</code>, <code>mmeRhs</code>: Left and right hand sides of MME</li><li><code>pedTrmVec</code>: Polygenic effect terms from pedigree</li><li><code>ped</code>: Pedigree object</li><li><code>rndTrmVec</code>: General random effects</li><li><code>R</code>: Residual variance (Variance struct)</li><li><code>M</code>: Genotypes object(s)</li><li><code>MCMCinfo</code>: MCMC configuration</li><li>Neural network fields for NNMM functionality</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/reworkhow/NNMM.jl/blob/a3fb92743aed49c2adfc117215a542a79256ea67/src/core/types.jl#L287-L319">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="NNMM.ModelTerm" href="#NNMM.ModelTerm"><code>NNMM.ModelTerm</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">ModelTerm</code></pre><p>A struct representing a single term in a model equation.</p><p><strong>Examples</strong></p><p>For model equations like &quot;y1 = A + B&quot; and &quot;y2 = A + B + A<em>B&quot;, ModelTerm instances would be created for terms: y1:A, y1:B, y2:A, y2:B, y2:A</em>B</p><p><strong>Fields</strong></p><ul><li><code>iModel</code>: Model equation number (1st, 2nd, etc.)</li><li><code>iTrait</code>: Trait name (&quot;y1&quot;, &quot;y2&quot;, etc.)</li><li><code>trmStr</code>: Term string (e.g., &quot;y1:A&quot;)</li><li><code>nFactors</code>: Number of factors in the term</li><li><code>factors</code>: Array of factor symbols</li><li><code>data</code>: String representations of factor levels</li><li><code>val</code>: Numeric values for the term</li><li><code>nLevels</code>: Number of levels for this term</li><li><code>names</code>: Level names</li><li><code>startPos</code>: Start position in incidence matrix</li><li><code>X</code>: Incidence matrix</li><li><code>random_type</code>: &quot;fixed&quot; or &quot;random&quot;</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/reworkhow/NNMM.jl/blob/a3fb92743aed49c2adfc117215a542a79256ea67/src/core/types.jl#L1-L23">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="NNMM.Omics" href="#NNMM.Omics"><code>NNMM.Omics</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">Omics</code></pre><p>A struct representing omics data (e.g., transcriptomics, metabolomics) in NNMM.</p><p><strong>Fields</strong></p><ul><li><code>name</code>: Name identifier for this omics category</li><li><code>trait_names</code>: Names for corresponding traits</li><li><code>obsID</code>: Row IDs for individuals</li><li><code>featureID</code>: Feature/omics variable IDs</li><li><code>nObs</code>: Number of observations</li><li><code>nFeatures</code>: Number of omics features</li><li><code>nMarkers</code>: Alias for nFeatures (compatibility)</li><li><code>centered</code>: Whether data is centered</li><li><code>data</code>: The omics data matrix</li><li><code>ntraits</code>: Number of traits in the model</li><li>Additional fields for Bayesian MCMC computations</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/reworkhow/NNMM.jl/blob/a3fb92743aed49c2adfc117215a542a79256ea67/src/nnmm/types.jl#L42-L59">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="NNMM.Phenotypes" href="#NNMM.Phenotypes"><code>NNMM.Phenotypes</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">Phenotypes</code></pre><p>A struct representing phenotype data in NNMM.</p><p><strong>Fields</strong></p><ul><li><code>obsID</code>: Individual IDs</li><li><code>featureID</code>: Phenotype/trait names</li><li><code>nObs</code>: Number of observations</li><li><code>nPheno</code>: Number of phenotypes</li><li><code>data</code>: Phenotype data matrix</li><li><code>nFeatures</code>: Alias for nPheno</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/reworkhow/NNMM.jl/blob/a3fb92743aed49c2adfc117215a542a79256ea67/src/nnmm/types.jl#L126-L138">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="NNMM.RandomEffect" href="#NNMM.RandomEffect"><code>NNMM.RandomEffect</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">RandomEffect</code></pre><p>A struct for general (including i.i.d.) random effects.</p><p>Assumes independence: cov(1:A, 1:B) = 0 unless A.names == B.names (e.g., pedigree terms).</p><p><strong>Examples</strong></p><ul><li>Single-trait: termarray = [ModelTerm(1:A)]</li><li>Multi-trait: termarray = [ModelTerm(1:A), ModelTerm(2:A)]</li></ul><p><strong>Fields</strong></p><ul><li><code>term_array</code>: Array of term strings</li><li><code>Gi</code>: Covariance matrix (Variance object)</li><li><code>GiOld</code>: Previous iteration value (for lambda version of MME)</li><li><code>GiNew</code>: Current iteration value (for lambda version of MME)</li><li><code>Vinv</code>: Inverse of relationship/covariance structure (0 for identity)</li><li><code>names</code>: Level names/IDs</li><li><code>randomType</code>: Type of random effect (&quot;A&quot; for additive genetic, etc.)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/reworkhow/NNMM.jl/blob/a3fb92743aed49c2adfc117215a542a79256ea67/src/core/types.jl#L120-L139">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="NNMM.ResVar" href="#NNMM.ResVar"><code>NNMM.ResVar</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">ResVar</code></pre><p>A struct for residual covariance matrix for all observations of size (nobs × nModels).</p><p>The Ri matrix is modified based on missing pattern (number of Ri = 2^ntraits - 1). This allows using the same incidence matrix X for all traits in multi-trait analyses.</p><p>In NNMM, this is ONLY used when:</p><ul><li>Residual variance is constant, or</li><li>Missing phenotypes are not imputed at each MCMC step (no marker effects)</li></ul><p><strong>Fields</strong></p><ul><li><code>R0</code>: Base residual covariance matrix</li><li><code>RiDict</code>: Dictionary mapping missing patterns to adjusted covariance matrices</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/reworkhow/NNMM.jl/blob/a3fb92743aed49c2adfc117215a542a79256ea67/src/core/types.jl#L99-L114">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="NNMM.Variance" href="#NNMM.Variance"><code>NNMM.Variance</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">Variance</code></pre><p>A struct for storing variance/covariance parameters used throughout NNMM.</p><p>Used for:</p><ul><li>Marker effect variances</li><li>Residual variances</li><li>Variance for non-genetic random effects</li></ul><p><strong>Fields</strong></p><ul><li><code>val</code>: Variance value (Float for single-trait, Matrix for multi-trait, or Bool=false if unset)</li><li><code>df</code>: Degrees of freedom for prior distribution</li><li><code>scale</code>: Scale parameter for prior distribution</li><li><code>estimate_variance</code>: Whether to estimate variance at each MCMC iteration</li><li><code>estimate_scale</code>: Whether to estimate scale at each MCMC iteration</li><li><code>constraint</code>: If true (multi-trait only), covariance between traits is zero</li></ul><p><strong>Example</strong></p><pre><code class="language-julia">v = Variance(1.5, 4.0, 1.3, true, false, false)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/reworkhow/NNMM.jl/blob/a3fb92743aed49c2adfc117215a542a79256ea67/src/core/types.jl#L64-L86">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="NNMM.PedModule.get_info-Tuple{NNMM.PedModule.Pedigree}" href="#NNMM.PedModule.get_info-Tuple{NNMM.PedModule.Pedigree}"><code>NNMM.PedModule.get_info</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">get_info(pedigree::Pedigree;Ai=false)</code></pre><ul><li>Print summary informtion from a pedigree object including number of individulas, sires. dams and founders. Return individual IDs, inverse of numerator relationship matrix, and inbreeding coefficients if <strong>Ai</strong>=<code>true</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/reworkhow/NNMM.jl/blob/a3fb92743aed49c2adfc117215a542a79256ea67/src/pedigree/PedModule.jl#L276-L282">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="NNMM.PedModule.get_pedigree-Tuple{Union{AbstractString, DataFrames.DataFrame}}" href="#NNMM.PedModule.get_pedigree-Tuple{Union{AbstractString, DataFrames.DataFrame}}"><code>NNMM.PedModule.get_pedigree</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">get_pedigree(pedfile::AbstractString;header=false,separator=&#39;,&#39;,missingstrings=[&quot;0&quot;])</code></pre><ul><li>Get pedigree informtion from a pedigree file with <strong>header</strong> (defaulting to <code>false</code>) , <strong>separator</strong> (defaulting to <code>,</code>) and missing values (defaulting to [&quot;0&quot;])</li><li>Pedigree file format:</li></ul><pre><code class="language-none">a,0,0
c,a,b
d,a,c</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/reworkhow/NNMM.jl/blob/a3fb92743aed49c2adfc117215a542a79256ea67/src/pedigree/PedModule.jl#L10-L21">source</a></section></article><p>–&gt;</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../public/">« Public</a><a class="docs-footer-nextpage" href="../../nnmm/Part1_introduction/">Part 1. Introduction »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Tuesday 30 December 2025 21:28">Tuesday 30 December 2025</span>. Using Julia version 1.10.10.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
